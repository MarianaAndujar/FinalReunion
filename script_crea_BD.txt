/**
*	@file   script_crea_BD.txt
* 
*	@author Black Butterfly
* 
*	@date   21/01/2015
* 
*	@brief  Ici se trouve le script de la cr�ation de la base de donn�es. 
*
**/

DROP TABLE IF EXISTS AVAILABLE;
DROP TABLE IF EXISTS HOURS;
DROP TABLE IF EXISTS DATE;
DROP TABLE IF EXISTS MEETING;
DROP TABLE IF EXISTS USER;


CREATE TABLE USER (
	ID_USER INT(100) NOT NULL auto_increment,
	LOGIN VARCHAR(70) NOT NULL,
	NAME VARCHAR(42) NOT NULL,
	SURNAME VARCHAR(42) NOT NULL,
	TEL VARCHAR(15),
	EMAIL VARCHAR(60) NOT NULL,
	PASSWD VARCHAR(144) NOT NULL,
	SALT VARCHAR(48) NOT NULL,
	PRIMARY KEY  (ID_USER)
)ENGINE=INNODB;

CREATE TABLE MEETING (
	ID_MEETING INT(100) NOT NULL auto_increment,
	SUBJECT VARCHAR(42) NOT NULL,
	DESCRIPTION VARCHAR(250),
	LOCATION VARCHAR(50) NOT NULL,
	DURATION INT(2) NOT NULL,
	ID_USER INT(100) NOT NULL,
	PRIMARY KEY (ID_MEETING),
	CONSTRAINT ID_USER_FKEY FOREIGN KEY (ID_USER) REFERENCES USER (ID_USER)
)ENGINE=INNODB;

CREATE TABLE DATE (
	ID_DATE INT(100) NOT NULL auto_increment,
	DDAY DATE NOT NULL,
	ID_MEETING INT(100) NOT NULL,
	PRIMARY KEY (ID_DATE),
	CONSTRAINT ID_MEETING_FKEY FOREIGN KEY (ID_MEETING) REFERENCES MEETING (ID_MEETING)
)ENGINE=INNODB;

CREATE TABLE HOURS (
	ID_HOURS INT(100) NOT NULL auto_increment,
	BHOUR INT(2) NOT NULL DEFAULT '8',
	ID_MEETING INT(100) NOT NULL,
	ID_DATE INT(100) NOT NULL,
	PRIMARY KEY (ID_HOURS),
	CONSTRAINT ID_DATE_FKEY FOREIGN KEY (ID_DATE) REFERENCES DATE (ID_DATE),
	CONSTRAINT ID_MEETINGH_FKEY FOREIGN KEY (ID_MEETING) REFERENCES MEETING (ID_MEETING)
)ENGINE=INNODB;

CREATE TABLE AVAILABLE (
    ID_AVAILABILITY INT(100) NOT NULL auto_increment,
	ID_MEETING INT(100) NOT NULL,
	ID_DATE INT(100) NOT NULL,
	ID_HOURS INT(100) NOT NULL,
	OWNER VARCHAR(42),
	ID_USER INT(100),
	PRIMARY KEY (ID_AVAILABILITY),
	CONSTRAINT ID_DATEA_FKEY FOREIGN KEY (ID_DATE) REFERENCES DATE (ID_DATE),
	CONSTRAINT ID_MEETINGA_FKEY FOREIGN KEY (ID_MEETING) REFERENCES MEETING (ID_MEETING),
	CONSTRAINT ID_HOURSA_FKEY FOREIGN KEY (ID_HOURS) REFERENCES HOURS (ID_HOURS)
)ENGINE=INNODB;